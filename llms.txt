![qesR logo](logo.png)

Access Quebec Election Study datasets in R.

## Installation

Install the development version from GitHub:

``` r
if (!requireNamespace("devtools", quietly = TRUE)) install.packages("devtools")
devtools::install_github("ThomasGareau/qesR")
```

## Using the package

The package provides access to QES surveys through:

- `get_qes(srvy)`: download a survey by code
- [`get_qescodes()`](https://thomasgareau.github.io/qesR/reference/get_qescodes.md):
  list survey codes and metadata
- `get_preview(srvy, obs)`: preview a survey
- `get_question(data, variable)`: retrieve question text
- `get_codebook(srvy)`: get survey codebook
- [`get_qes_master()`](https://thomasgareau.github.io/qesR/reference/get_qes_master.md):
  build a harmonized merged dataset

## Examples

``` r
library(qesR)

# list survey call codes
get_qescodes()

# load one survey
qes2022 <- get_qes("qes2022")

# preview observations
get_preview("qes2022", 10)

# retrieve question text
get_question(qes2022, "cps_age_in_years", full = TRUE)

# build merged cross-study dataset
master <- get_qes_master(strict = FALSE)
head(master)
```

## Details

- downloaded survey files are read and returned in labelled form
- codebook metadata is attached and available through
  [`get_codebook()`](https://thomasgareau.github.io/qesR/reference/get_codebook.md)
- merged dataset creation includes harmonization, de-duplication, and
  filtering of empty rows
- source-variable provenance is available via
  `attr(master, "source_map")`

## Merged dataset

`qesR` includes a merged harmonized dataset workflow:

``` r
get_qes_master(save_path = "qes_master.csv", strict = FALSE)
get_qes_master(save_path = "qes_master.rds", strict = FALSE)
```

What it harmonizes:

Current harmonized columns in `qes_master`:

`qes_code`, `qes_year`, `qes_name_en`, `respondent_id`,
`interview_start`, `interview_end`, `interview_recorded`, `language`,
`citizenship`, `year_of_birth`, `age`, `age_group`, `gender`,
`province_territory`, `education`, `income`, `religion`, `born_canada`,
`political_interest`, `ideology`, `turnout`, `vote_choice`,
`vote_choice_text`, `party_best`, `party_lean`, `sovereignty_support`,
`sovereignty`, `federal_pid`, `provincial_pid`, `survey_weight`,
`definibin`, `ethn1`, `influperso`, `luentend`, `occup`, `patron`,
`pondam1`, `laide_familles_etait_enjeu_important_election_q10`,
`principale_source_dinformation_politique_ne_pas_lire_q16`,
`deuxieme_source_dinformation_politique_television_radio_journaux_q17`,
`which_party_best_managing_health_care_system_q18`,
`gens_ont_differentes_facons_se_definir_diriez_considerez_q18a`,
`gens_ont_differentes_facons_se_definir_diriez_considerez_q18b`,
`eme_si_navez_peut_pas_encore_fait_choix_q20`,
`which_party_best_fighting_corruption_q20b`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q22`,
`mesure_faites_confiance_gouvernements_faire_doit_fait_leur_q23`,
`pensez_gens_gouvernement_gaspillent_beaucoup_quelque_peu_ou_q24`,
`leducation_etait_enjeu_important_election_q3`,
`echelle_zero_cent_zero_veut_dire_naimez_vraiment_q31`,
`personnellement_trouvez_lidee_tenir_election_quebec_automne_etai_q33`,
`recemment_gouvernement_quebec_commence_envisager_possibilite_mod_q35`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q37`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q38`,
`maintenant_nous_parlons_chefs_partis_utilisant_echelle_zero_q39`,
`according_what_main_difference_between_quebecois_people_peopl_q4`,
`maintenant_nous_parlons_chefs_partis_utilisant_echelle_zero_q40`,
`maintenant_nous_parlons_chefs_partis_utilisant_echelle_zero_q41`,
`maintenant_nous_parlons_chefs_partis_utilisant_echelle_zero_q42`,
`maintenant_nous_parlons_chefs_partis_utilisant_echelle_zero_q43`,
`selon_lequel_chefs_parti_plus_competent_ne_pas_q44`,
`would_say_canadian_government_intervenes_too_much_affairs_q45`,
`selon_lequel_chefs_parti_plus_proche_gens_ne_q46`,
`selon_leconomie_quebecoise_sest_elle_amelioree_deterioree_ou_q47`,
`considerez_surtout_comme_federaliste_surtout_comme_souverainiste_q48`,
`dapres_lavenir_q49`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q50`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q51`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q53`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q54`,
`selon_parti_politique_meilleur_ameliorer_soins_sante_ne_q55`,
`if_had_choose_between_no_change_more_powers_q56`,
`parti_meilleur_proteger_lenvironnement_ne_pas_lire_liste_q58`,
`parti_meilleur_lutter_contre_pauvrete_ne_pas_lire_q59`,
`it_important_quebec_has_sufficient_voice_central_decision_q60`,
`parti_meilleur_defendre_lidentite_culture_quebecoise_ne_pas_q61b`,
`parti_meilleur_soccuper_caisse_dep_ot_placement_quebec_q61d`,
`each_following_areas_think_decisions_should_made_by_q62a`,
`each_following_areas_think_decisions_should_made_by_q62b`,
`echelle_va_100_ou_veut_dire_naimez_vraiment_q64`,
`echelle_va_100_ou_veut_dire_naimez_vraiment_q65`,
`etes_ou_contre_mariage_entre_personnes_eme_sexe_q66`,
`veuillez_indiquer_si_etes_fortement_daccord_plut_ot_q68`,
`baisses_dimp_ots_etaient_enjeu_important_election_q7`,
`politique_provinciale_habituellement_identifiez_q70`,
`sentez_peu_plus_proche_lun_ou_lautre_partis_q72`, `parti_q73`,
`lors_derniere_election_federale_janvier_2006_parti_avez_q74`,
`travaillez_actuellement_compte_etes_salarie_avez_pris_retraite_q79`,
`statut_politique_quebec_etait_enjeu_important_election_q8`,
`langue_parlez_plus_souvent_maison_q80`,
`some_people_say_governments_should_see_it_every_q81`,
`pauvrete_etait_enjeu_important_election_q9`,
`raison_vote_recodee_raison1`, `raison_vote_recodee_raison2`,
`jour_semaine_s_jse`,
`diriez_etes_tres_satisfait_plut_ot_satisfait_plut_satisf`,
`var_27_personnellement_jusqua_point_fiez_sondages_savoir_gagnera_sefie`,
`var_28a_diriez_sondages_pendant_campagnes_electorales_tres_bonne_sondbons`,
`var_15a_parti_avez_vote_dernieres_elections_provinciales_davril_voteprec`

Harmonization applies value normalization, derived age groups,
within-study de-duplication, and removal of rows that are empty across
harmonized variables.

Opaque legacy variables (for example `q10`, `q16`, `voteprec`) are
renamed to readable merged names. The old-to-new mapping is available
via `attr(master, "variable_name_map")` and in the saved sidecar file
`qes_master_variable_name_map.csv`.

See: [Merged
Dataset](https://thomasgareau.github.io/qesR/articles/merged-dataset.md)

## Survey code table

| year      | code                 | name                                  |
|-----------|----------------------|---------------------------------------|
| 2022      | `qes2022`            | Quebec Election Study 2022            |
| 2018      | `qes2018`            | Quebec Election Study 2018            |
| 2018      | `qes2018_panel`      | Quebec Election Study 2018 Panel      |
| 2014      | `qes2014`            | Quebec Election Study 2014            |
| 2012      | `qes2012`            | Quebec Election Study 2012            |
| 2012      | `qes2012_panel`      | Quebec Election Study 2012 Panel      |
| 2007-2010 | `qes_crop_2007_2010` | CROP Quebec Opinion Polls (2007-2010) |
| 2008      | `qes2008`            | Quebec Election Study 2008            |
| 2007      | `qes2007`            | Quebec Election Study 2007            |
| 2007      | `qes2007_panel`      | Quebec Election Study 2007 Panel      |
| 1998      | `qes1998`            | Quebec Elections 1998                 |

## Citations

Full citations for all studies are listed in:

- [Study
  Citations](https://thomasgareau.github.io/qesR/articles/study-citations.md)

## Use cases

Use cases available in separate tabs:

- [Evolution of sovereignty
  attitudes](https://thomasgareau.github.io/qesR/articles/analysis-sovereignty.md)
- [Vote-choice patterns over
  time](https://thomasgareau.github.io/qesR/articles/analysis-vote-choice.md)

## Version française

Use the `FR` button in the top bar to switch any main page to its French
version.

# Package index

## Package

- [`qesR-package`](https://thomasgareau.github.io/qesR/reference/qesR-package.md)
  : qesR: Access Quebec Election Study Datasets

## Download Studies

- [`get_qescodes()`](https://thomasgareau.github.io/qesR/reference/get_qescodes.md)
  : List Quebec Election Study Survey Codes
- [`get_qes()`](https://thomasgareau.github.io/qesR/reference/get_qes.md)
  : Download and Load a Quebec Election Study
- [`get_preview()`](https://thomasgareau.github.io/qesR/reference/get_preview.md)
  : Preview a Quebec Election Study

## Codebook Tools

- [`get_codebook()`](https://thomasgareau.github.io/qesR/reference/get_codebook.md)
  : Get a Quebec Election Study Codebook
- [`get_qes_codebook()`](https://thomasgareau.github.io/qesR/reference/get_qes_codebook.md)
  : Alias for get_codebook
- [`qes_codebook()`](https://thomasgareau.github.io/qesR/reference/qes_codebook.md)
  : Alias for get_codebook
- [`format_codebook()`](https://thomasgareau.github.io/qesR/reference/format_codebook.md)
  : Reformat a qesR Codebook
- [`get_value_labels()`](https://thomasgareau.github.io/qesR/reference/get_value_labels.md)
  : Get Value Labels from a Codebook
- [`get_question()`](https://thomasgareau.github.io/qesR/reference/get_question.md)
  : Get Survey Question Text
- [`get_codebook_files()`](https://thomasgareau.github.io/qesR/reference/get_codebook_files.md)
  : Get Codebook Files
- [`get_qes_codebook_files()`](https://thomasgareau.github.io/qesR/reference/get_qes_codebook_files.md)
  : Alias for get_codebook_files
- [`download_codebook()`](https://thomasgareau.github.io/qesR/reference/download_codebook.md)
  : Download Codebook Files

## Harmonized Data

- [`get_decon()`](https://thomasgareau.github.io/qesR/reference/get_decon.md)
  : Create a Prepared Non-Exhaustive qesR Dataset
- [`get_qes_master()`](https://thomasgareau.github.io/qesR/reference/get_qes_master.md)
  : Build a Harmonized Stacked Master QES Dataset

# Articles

### Tutorials

- [Getting Started with
  qesR](https://thomasgareau.github.io/qesR/articles/get-started.md):
- [Merged Dataset
  Workflow](https://thomasgareau.github.io/qesR/articles/merged-dataset.md):
- [Study
  Citations](https://thomasgareau.github.io/qesR/articles/study-citations.md):
- [Use case: Evolution of Sovereignty
  Attitudes](https://thomasgareau.github.io/qesR/articles/analysis-sovereignty.md):
- [Use case: Descriptive
  Statistics](https://thomasgareau.github.io/qesR/articles/analysis-descriptive.md):
- [Use case: Vote Choice Over
  Time](https://thomasgareau.github.io/qesR/articles/analysis-vote-choice.md):
- [Démarrage avec
  qesR](https://thomasgareau.github.io/qesR/articles/fr-demarrage.md):
- [Données fusionnées
  harmonisées](https://thomasgareau.github.io/qesR/articles/fr-donnees-fusionnees.md):
- [Citations des
  études](https://thomasgareau.github.io/qesR/articles/fr-citations-etudes.md):
- [Cas d'usage : évolution des attitudes liées à la
  souveraineté](https://thomasgareau.github.io/qesR/articles/fr-analyse-souverainete.md):
- [Analyse : statistiques
  descriptives](https://thomasgareau.github.io/qesR/articles/fr-analyse-descriptive.md):
- [Cas d'usage : évolution du choix de
  vote](https://thomasgareau.github.io/qesR/articles/fr-analyse-choix-vote.md):
